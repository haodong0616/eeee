# Next.js ä»£ç†é…ç½®è¯´æ˜

## æ¶æ„è®¾è®¡

```
æ‰‹æœºæµè§ˆå™¨
    â†“
http://192.168.1.100:3000
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next.js æœåŠ¡å™¨ (3000)   â”‚
â”‚  â”œâ”€ API Routes ä»£ç†      â”‚ â†’ http://localhost:8080/api/*
â”‚  â””â”€ WebSocket ä»£ç†       â”‚ â†’ ws://localhost:8080/ws
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
åç«¯æœåŠ¡å™¨ (localhost:8080)
```

## æ–‡ä»¶è¯´æ˜

### 1. `server.js` - è‡ªå®šä¹‰æœåŠ¡å™¨
- æä¾› Next.js é¡µé¢æœåŠ¡
- ä»£ç† WebSocket è¿æ¥
- ç›‘å¬ `0.0.0.0:3000`

### 2. `app/api/[...path]/route.ts` - API ä»£ç†
- ä»£ç†æ‰€æœ‰ `/api/*` è¯·æ±‚åˆ°åç«¯
- æ”¯æŒ GET, POST, PUT, DELETE
- è‡ªåŠ¨è½¬å‘ Authorization å¤´

### 3. `lib/services/api.ts` - API é…ç½®
```typescript
const API_URL = '';  // ç©ºå­—ç¬¦ä¸² = ä½¿ç”¨ç›¸å¯¹è·¯å¾„
// è¯·æ±‚ä¼šå‘é€åˆ°: /api/market/tickers
// Next.js ä»£ç†åˆ°: http://localhost:8080/api/market/tickers
```

### 4. `lib/websocket.ts` - WebSocket é…ç½®
```typescript
// WebSocket è¿æ¥åˆ° Next.js æœåŠ¡å™¨
ws://192.168.1.100:3000/ws
// Next.js è½¬å‘åˆ°åç«¯
ws://localhost:8080/ws
```

## å¯åŠ¨æ–¹å¼

### å¼€å‘ç¯å¢ƒ

```bash
# 1. å¯åŠ¨åç«¯
cd backend
go run main.go

# 2. å®‰è£… ws ä¾èµ–ï¼ˆé¦–æ¬¡ï¼‰
cd frontend
npm install ws

# 3. å¯åŠ¨å‰ç«¯ï¼ˆä½¿ç”¨è‡ªå®šä¹‰æœåŠ¡å™¨ï¼‰
npm run dev
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
cd frontend
npm run build
npm start
```

## ç¯å¢ƒå˜é‡

åˆ›å»º `frontend/.env.local`ï¼ˆå¯é€‰ï¼‰ï¼š

```env
# åç«¯åœ°å€ï¼ˆæœåŠ¡ç«¯ä½¿ç”¨ï¼‰
BACKEND_URL=localhost:8080

# å¦‚æœåç«¯åœ¨å…¶ä»–æœåŠ¡å™¨
# BACKEND_URL=192.168.1.200:8080
```

## ä¼˜åŠ¿

1. **é›¶é…ç½®**ï¼šæ‰‹æœºè®¿é—®æ—¶å®Œå…¨è‡ªåŠ¨
2. **ç»Ÿä¸€å…¥å£**ï¼šæ‰€æœ‰è¯·æ±‚éƒ½é€šè¿‡å‰ç«¯
3. **é¿å…è·¨åŸŸ**ï¼šæµè§ˆå™¨åªè®¿é—®ä¸€ä¸ªåŸŸå
4. **WebSocket æ”¯æŒ**ï¼šå®æ—¶æ•°æ®æ­£å¸¸å·¥ä½œ
5. **å®‰å…¨**ï¼šåç«¯ä¸å¯¹å¤–æš´éœ²

## æµ‹è¯•

### 1. ç”µè„‘æµ‹è¯•
```bash
curl http://localhost:3000/api/market/tickers
```

### 2. æ‰‹æœºæµ‹è¯•
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
```
http://192.168.1.100:3000
```

### 3. WebSocket æµ‹è¯•
åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼š
```javascript
const ws = new WebSocket('ws://192.168.1.100:3000/ws');
ws.onopen = () => console.log('âœ… WebSocket è¿æ¥æˆåŠŸ');
ws.onmessage = (e) => console.log('ğŸ“¨', e.data);
```

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: Module not found: ws

**è§£å†³**ï¼š
```bash
cd frontend
npm install ws
npm install -D @types/ws
```

### é—®é¢˜2: WebSocket è¿æ¥å¤±è´¥

**æ£€æŸ¥**ï¼š
1. åç«¯æ˜¯å¦è¿è¡Œï¼Ÿ
2. åç«¯ç«¯å£æ˜¯å¦æ˜¯ 8080ï¼Ÿ
3. æµè§ˆå™¨æ§åˆ¶å°æœ‰ä»€ä¹ˆé”™è¯¯ï¼Ÿ

### é—®é¢˜3: API è¯·æ±‚ 404

**æ£€æŸ¥**ï¼š
1. `app/api/[...path]/route.ts` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿ
2. é‡å¯å‰ç«¯æœåŠ¡

## npm scripts

- `npm run dev` - å¯åŠ¨è‡ªå®šä¹‰æœåŠ¡å™¨ï¼ˆæ”¯æŒä»£ç†ï¼‰
- `npm run dev:next` - åŸç”Ÿ Next.js å¼€å‘æ¨¡å¼ï¼ˆæ— ä»£ç†ï¼‰
- `npm start` - ç”Ÿäº§æ¨¡å¼è‡ªå®šä¹‰æœåŠ¡å™¨
- `npm run start:next` - åŸç”Ÿ Next.js å¯åŠ¨

æ¨èä½¿ç”¨ `npm run dev` è·å¾—å®Œæ•´åŠŸèƒ½ï¼


